# ソフトウェア開発：テストの種類

## テストの種類

- [単体テスト，結合テスト，システムテスト，受け入れテスト](https://maku77.github.io/memo/test-relation.html)

（）内は別の表現

- 単体テスト（ユニットテスト）
- 結合テスト
- システムテスト
- 受け入れ

## システムテストと受け入れテスト

「システムテスト」は，システム全体を『開発者視点』でテストする．「受け入れテスト」は，「システムテスト」と同様に，システム全体がテスト対象であり，テスト項目も多少かぶる部分があるが，システム全体の振る舞いを『ユーザ（発注者）視点』でテストする点が異なる．

- システムテスト
  - 対象：システム全体
  - 視点：**開発者視点**
- 受け入れテスト
  - 対象：システム全体
  - 視点：**ユーザ（発注者）視点**

## 単体テストと結合テスト

システム内の構成要素を捉えるときの「粒度の違い」によって単体テストと結合テストに区別される．例えば，以下のような例が考えられる．

- 例 1
  - 単体テスト：クラス
  - 結合テスト：複数のクラスから構成されたコンポーネント
- 例 2
  - 単体テスト：1 つのモジュール
  - 結合テスト：複数のモジュールから構成されたパッケージ

以上のように，テスト対象により粒度はさまざまである．そのため，「単体テスト」の粒度での「結合テスト」もあるし，「結合テスト」の粒度での「単体テスト」もある．つまり，

- 単体テストのテスト対象は 1 つ
- 結合テストのテスト対象は，単体テストの対象を組み合わせたもの

ではあるが，常に「**ただし，それぞれの粒度はプロジェクトにより異なる**」という文言がついて回る．

## 単体テストとシステム開発

単体テストのテスト対象は 1 つと述べたが，実際にはクラスやメソッドを対象としたプログラムを検証するためのテストとして扱われることが多い．ソフトウェア開発で扱うテストの中では最も小さい粒度のテストである．

単体テストでは，テスト対象を 1 つの要素に限定するため，問題を発見したときの問題個所の絞り込みが容易である．結合テストだけでは，単一要素に含まれる不具合を発見できないことがある．**潜在的な不具合を防ぐには，単体テストが重要な役割を果たす**といえる．

大規模なシステムになるほど単体テストの重要性は増してくるが，各モジュールの依存関係をあらかじめ考慮した上で設計を進めないと，依存関係に縛られて単体テストが行えないコードができてしまう．そうならないためにも，実装を進める前に，

- テスト仕様（インターフェース仕様）
- テストコード

の作成を行い，テストファーストで実装していくのが効果的（いわゆる「**テスト駆動開発**」，「**TDD**」）．特に，複数人で開発を進める場合，テストを作成することで最終的に完成するもののイメージを共有するという目的もある．**インターフェース部分のテストが用意されていれば，それを見るだけでそのシステムで何をしようとするのかが理解できる**．

ただし，テスト対象となる要素が単純な演算ライブラリのようなものでない限り，いざ，単体テストを行う場面になったとき，他の要素との依存関係に悩まされる．単体テストは，あくまで単一の要素の動作を検証しなければならないため，他の要素の実装の進捗によってテスト結果が変わるようなことがあってはならない．そんなときに，以下のようなダミーモジュールを作成し，他の要素の動作を切り離す．

- ドライバ
  - テスト対象を起動，操作するためのモジュール
- スタブ
  - テスト対象内部で呼び出している下位のモジュール

ドライバ，スタブの作成自体が困難だと思った場合，そのモジュールに責務を詰め込みすぎていないか，設計を見直すべき合図でもある．

システムの実装は，「**下位モジュールからボトムアップで完成していく**」ものであるため，テストが成功していく順番も，単体テスト -> 結合テストの順になる．とはいえ，最終的なシステム全体の振る舞いを表現しているのは，より上位のテストである．テスト仕様は，トップダウンで作っていくのが望ましい．
